/**
 * @license
 * Copyright LOGO YAZILIM SANAYİ VE TİCARET A.Ş. All Rights Reserved.
 *
 * Save to the extent permitted by law, you may not use, copy, modify,
 * distribute or create derivative works of this material or any part
 * of it without the prior written consent of LOGO YAZILIM SANAYİ VE TİCARET A.Ş. Limited.
 * Any reproduction of this material must contain this notice.
 */

@import "~@logo-software/icons/src/lib/logo-icons.scss";
@import "~@logo-software/theme/src/lib/style";

$font-family: 'Nunito', sans-serif !important;
$thead-background-color: #0090ff;
$thead-border-color: #0076ff;
$thead-filter-background-color: #0069e3;
$thead-input-background: #f2f4f9;
$thead-input-color: #8c92a1;
$td-font-color: #4a4a4a;
$table-border-color: lighten($thead-background-color, 30);
$table-odd-background: #f9f9ff;
$table-even-background: #ffffff;
$button-accept-bg-color: #01cc78;
$button-cancel-bg-color: #ffffff;
$button-border-color: #e5e5e5;
$button-hover-background-color: #fafafa;
$box-shadow: 0 0 4px 0 rgba(0, 0, 0, 0.2);
$border-radius: 2px;
$border-width: 1px;
$button-selected: #0090ff;
$expanded-background-color: #dddde8;

@mixin animate($time:0.1s, $event: all, $animate:linear) {
  transition: $event $time $animate;
}

:host {
  ::ng-deep {
    color: darken(#90a4b9, 30);
    display: block;
    font-size: 12px;

    .table-container {
      position: relative;
      overflow: auto;
      border-bottom: 1px solid rgba($thead-background-color, 0.1);
      font-family: $font-family;
      font-size: 14px;

      table {
        border-collapse: separate;
        border-spacing: 0;
        width: 100%;
        position: relative;

        thead {
          tr {
            th {
              position: sticky;
              top: 0;
              z-index: 0;
              padding: 2px 5px;
              background-color: $thead-background-color;
              border-right: 1px solid $thead-border-color;
              cursor: pointer;
              white-space: nowrap;
              text-align: left;
              height: 32px;
              box-sizing: border-box;
              font-size: 12px;
              font-weight: 800;
              font-stretch: normal;
              font-style: normal;
              line-height: normal;
              letter-spacing: normal;
              color: #ffffff;

              &.index {
                min-width: 20px;
                text-align: center;
              }

              &.logo-arrow-down {
                &::before {
                  @include animate();
                  height: size(7px);
                  width: size(10px);
                }
              }

              &.logo-arrow-up {
                &::before {
                  @include animate();
                  height: size(7px);
                  width: size(10px);
                }
              }

              &.filter {
                background-color: $thead-filter-background-color;
                border-right: 1px solid $thead-background-color;
                text-align: center;
                height: 42px;

                label {
                  display: block;

                  input {
                    border: none;
                    padding: 0;
                    width: 100%;
                    text-indent: 5px;
                    font-size: 14px;
                    height: 32px;
                    border-radius: 2px;
                    background-color: $thead-input-background;
                    color: $thead-input-color;
                    font-family: $font-family;
                    font-stretch: normal;
                    font-style: normal;
                    line-height: normal;
                    letter-spacing: normal;
                  }

                  input:disabled {
                    opacity: 0.4;
                  }
                }
              }

              &.checkbox {
                text-align: center;
              }

              &:last-child {
                border: none;
              }
            }

            &:first-child th {
              z-index: 1;
            }
          }
        }

        tbody {
          tr {
            td {
              color: $black;
              font-weight: normal;
              font-stretch: normal;
              font-style: normal;
              line-height: normal;
              letter-spacing: normal;
              height: size(32px);
              padding: 0;
              vertical-align: middle;

              button {
                margin-right: size(4px);

                &.expander {
                  background-color: $white;
                  margin-left: size(4px);
                }
              }

              &.checkbox {
                text-align: center;
              }

              &.index {
                text-align: center;
                background-color: transparentize($thead-background-color, 0.2);
                color: #ffffff;
              }

              div.content-container {
                display: flex;
                align-items: center;
                width: 100%;
                height: 100%;
                box-sizing: border-box;
                padding: 4px 0;

                span.content {
                  display: flex;
                  flex-grow: 1;
                  align-items: center;
                  width: 100%;
                  height: 100%;
                  padding-left: 5px;
                  position: relative;

                  input {
                    width: 100%;
                    height: 100%;
                    margin-right: size(2px);
                    padding: 0;
                    background-color: transparent;
                    border: none;
                    outline: none;
                    font-size: 14px;
                    font-weight: normal;
                    font-stretch: normal;
                    font-style: normal;
                    line-height: normal;
                    letter-spacing: normal;
                    color: #4a4a4a;
                    font-family: $font-family;
                    cursor: pointer;
                  }

                  button {
                    display: none;
                    position: absolute;
                    z-index: 2;
                    margin-right: size(4px);
                  }
                }

                &:hover {
                  box-shadow: $box-shadow;

                  button.edit-pen {
                    background-color: $white;
                    display: inline-block;
                    right: 0;
                    margin-right: 4px;
                  }
                }
              }

              &.edit-focus, &:focus {
                box-shadow: $box-shadow;

                div.content-container {
                  .content {
                    input {
                      margin-right: 60px;

                      & ~ button.edit-accept {
                        display: inline-block;
                        right: 0;
                      }

                      & ~ button.edit-cancel {
                        background-color: $white;
                        display: inline-block;
                        right: size(28px);
                      }

                      & ~ button.edit {
                        background-color: $white;
                        display: none;
                      }
                    }
                  }
                }
              }
            }

            &.selected {
              td {
                background: rgba($thead-background-color, 0.3);
              }
            }

            &.even {
              background-color: $table-even-background;
            }

            &.odd {
              background-color: $table-odd-background;
            }

            &:last-child {
              td {
                border-bottom: none;
              }
            }

            &:hover {
              background: rgba($thead-background-color, 0.1);
            }

            &.new-line {
              background-color: rgba(255, 255, 0, 0.2);
            }

            &.expanded {
              background-color: $expanded-background-color;

              td.expanded-td {
                padding: size(10px);
              }
            }
          }
        }

        .no-data {
          text-align: center;
        }
      }
    }
  }
}

:host.no-bootstrap {
  .table {
    margin-bottom: 0;

    thead {
      th {
        border-top: 0;
        border-bottom: 0;
        vertical-align: inherit;

        label {
          margin-bottom: 0;
        }
      }
    }
  }
}

:host ::ng-deep {
  table.table-editing tbody tr td {
    $effect: 1px dotted rgba(0, 0, 0, 0.21);
    border-bottom: 1px dotted rgba(255, 0, 0, 0.21);

    &.editable {
      border-right: $effect;
      border-bottom: $effect;
    }

    &.editing {
      box-sizing: border-box;
      background-color: rgba(0, 180, 94, 0.2);
      // border: 1px solid rgba(0, 180, 94, 0.5);
    }

    &.editable + &.editable {
      border-left: 1px solid transparent;
    }

    &:not(.editable) + .editable {
      border-left: $effect;
    }
  }

  .table-actions {
    display: flex;
    padding: size(10px) 0;
    justify-content: flex-end;

    button {
      margin-right: size(10px);
    }

    :last-child {
      margin-right: 0;
    }
  }
}
