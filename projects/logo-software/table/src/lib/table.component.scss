/**
 * @license
 * Copyright LOGO YAZILIM SANAYİ VE TİCARET A.Ş. All Rights Reserved.
 *
 * Save to the extent permitted by law, you may not use, copy, modify,
 * distribute or create derivative works of this material or any part
 * of it without the prior written consent of LOGO YAZILIM SANAYİ VE TİCARET A.Ş. Limited.
 * Any reproduction of this material must contain this notice.
 */

@import "~@logo-software/icons/src/lib/logo-icons.scss";

$font-family: 'Nunito', sans-serif !important;
$thead-background-color: #0090ff;
$thead-border-color: #0076ff;
$thead-filter-background-color: #0069e3;
$thead-input-background: #f2f4f9;
$thead-input-color: #8c92a1;
$td-font-color: #4a4a4a;
$table-border-color: lighten($thead-background-color, 30);
$table-odd-background: #f9f9ff;
$table-even-background: #ffffff;
$button-accept-bg-color: #01cc78;
$button-cancel-bg-color: #ffffff;
$button-border-color: #e5e5e5;
$button-hover-background-color: #fafafa;
$box-shadow: 0 0 4px 0 rgba(0, 0, 0, 0.2);
$border-radius: 2px;
$border-width: 1px;
$button-selected: #0090ff;
$expanded-background-color: #dddde8;

@mixin animate($time:0.1s, $event: all, $animate:linear) {
  transition: $event $time $animate;
}

:host {
  ::ng-deep {
    color: darken(#90a4b9, 30);
    display: block;
    font-size: 12px;

    .table-container {
      position: relative;
      overflow: auto;
      border-bottom: 1px solid rgba($thead-background-color, 0.1);
      font-family: $font-family;
      font-size: 14px;

      table {
        border-collapse: separate;
        border-spacing: 0;
        width: 100%;
        position: relative;

        thead {
          tr {
            th {
              position: sticky;
              top: 0;
              z-index: 0;
              padding: 2px 5px;
              background-color: $thead-background-color;
              border-right: 1px solid $thead-border-color;
              cursor: pointer;
              white-space: nowrap;
              text-align: left;
              height: 32px;
              box-sizing: border-box;
              font-size: 12px;
              font-weight: 800;
              font-stretch: normal;
              font-style: normal;
              line-height: normal;
              letter-spacing: normal;
              color: #ffffff;

              &.index {
                min-width: 20px;
                text-align: center;
              }

              &.sort-asc {
                &::before {
                  content: "\f0d7";
                  display: inline-block;
                  @include animate();
                }
              }

              &.sort-desc {
                &::before {
                  content: "\f0d7";
                  display: inline-block;
                  // TODO @include rotate(180deg);
                  // TODO @include animate();
                }
              }

              &.filter {
                background-color: $thead-filter-background-color;
                border-right: 1px solid $thead-background-color;
                text-align: center;
                height: 42px;

                label {
                  display: block;

                  input {
                    border: none;
                    padding: 0;
                    width: 100%;
                    text-indent: 5px;
                    font-size: 14px;
                    height: 32px;
                    border-radius: 2px;
                    background-color: $thead-input-background;
                    color: $thead-input-color;
                    font-family: $font-family;
                    font-stretch: normal;
                    font-style: normal;
                    line-height: normal;
                    letter-spacing: normal;
                  }

                  input:disabled {
                    opacity: 0.4;
                  }
                }
              }

              &:last-child {
                border: none;
              }
            }

            &:first-child th {
              z-index: 1;
            }
          }
        }

        tbody {
          tr {
            td {
              color: $td-font-color;
              font-size: 14px;
              font-weight: normal;
              font-stretch: normal;
              font-style: normal;
              line-height: normal;
              letter-spacing: normal;
              height: 32px;
              padding: 0;
              vertical-align: middle;

              &.index {
                text-align: center;
                background-color: transparentize($thead-background-color, 0.2);
                color: #ffffff;
              }

              &:last-child {
                // border-right: 1px solid rgba($background, 0.1);
              }

              &:first-child {
                // border-left: 1px solid rgba($background, 0.1);
              }

              button {
                min-width: 24px;
                height: 24px;
                margin: 0 2px;
                outline: none;
                cursor: pointer;
                box-sizing: border-box;
                border-radius: $border-radius;
                border: $border-width solid $button-border-color;
                background-position: center;
                background-color: #ffffff;
              }

              div.content-container {
                display: flex;
                align-items: center;
                width: 100%;
                height: 100%;
                box-sizing: border-box;
                padding: 4px 0;

                button.expander {
                  flex-shrink: 1;
                  min-width: 24px;
                  height: 24px;
                  padding: 0;
                  background: none;
                  margin-left: 5px;
                  outline: none;
                  cursor: pointer;
                  border: $border-width solid $button-border-color;
                  border-radius: $border-radius;

                  &.visible {
                    opacity: 1;
                  }

                  &.expander-add {
                    background-color: #ffffff;
                    @extend .logo-add;
                  }

                  &.expander-remove {
                    background-color: #ffffff;
                    @extend .logo-remove;
                  }
                }

                span.content {
                  display: flex;
                  flex-grow: 1;
                  align-items: center;
                  width: 100%;
                  height: 100%;
                  padding-left: 5px;
                  position: relative;

                  input {
                    width: 100%;
                    height: 100%;
                    margin: 0;
                    padding: 0;
                    background-color: transparent;
                    border: none;
                    outline: none;
                    font-size: 14px;
                    font-weight: normal;
                    font-stretch: normal;
                    font-style: normal;
                    line-height: normal;
                    letter-spacing: normal;
                    color: #4a4a4a;
                    font-family: $font-family;
                    cursor: pointer;
                  }

                  button {
                    display: none;
                    position: absolute;
                    z-index: 2;
                    right: 0;
                    background: none;
                    padding: 0;
                    border: $border-width solid $button-border-color;;

                    &:last-child {
                      margin-right: 4px;
                    }
                  }
                }
              }

              &.editable {
                min-width: 100px;

                div.content-container {
                  box-sizing: border-box;

                  &:hover {
                    box-shadow: $box-shadow;
                    border: 1px solid red;

                    .content {
                      input {
                        ~ button.edit-pen {
                          display: inline-block;
                          margin-right: 4px;
                          background-color: #ffffff;
                          @extend .logo-edit-pen;
                          border: $border-width solid $button-border-color;
                        }
                      }
                    }
                  }
                }
              }

              &.edit-focus, &:focus {
                box-shadow: $box-shadow;

                div.content-container {
                  .content {
                    input {
                      margin-right: 60px;

                      & ~ button.edit-accept {
                        color: #ffffff;
                        display: inline-block;
                        right: 0;
                        border: none;
                        background-color: $button-accept-bg-color;
                        @extend .logo-small-check;
                      }

                      & ~ button.edit-cancel {
                        display: inline-block;
                        right: 30px;
                        background-color: #ffffff;
                        @extend .logo-small-cross;
                      }

                      & ~ button.edit {
                        display: none;
                      }
                    }
                  }
                }
              }
            }

            &.selected {
              td {
                background: rgba($thead-background-color, 0.3);

                div.content-container {
                  border: 1px solid green;

                  span.content {
                    button {
                      border: none;
                    }
                  }
                }
              }
            }

            &.even {
              background-color: $table-even-background;
            }

            &.odd {
              background-color: $table-odd-background;
            }

            &:last-child {
              td {
                border-bottom: none;
              }
            }

            &:hover {
              background: rgba($thead-background-color, 0.1);
            }

            &.new-line {
              background-color: rgba(255, 255, 0, 0.2);

              td {
                // border: 1px dotted red;
              }
            }

            &.expanded {
              background-color: $expanded-background-color;

              td.expanded-td {
                padding: 10px;
              }
            }
          }
        }

        .no-data {
          text-align: center;
        }
      }
    }
  }
}

:host.no-bootstrap {
  .table {
    margin-bottom: 0;

    thead {
      th {
        border-top: 0;
        border-bottom: 0;
        vertical-align: inherit;

        label {
          margin-bottom: 0;
        }
      }
    }
  }
}

:host ::ng-deep {
  table.table-editing tbody tr td {
    $effect: 1px dotted rgba(0, 0, 0, 0.21);
    border-bottom: 1px dotted rgba(255, 0, 0, 0.21);

    &.editable {
      border-right: $effect;
      border-bottom: $effect;
    }

    &.editing {
      box-sizing: border-box;
      background-color: rgba(0, 180, 94, 0.2);
      // border: 1px solid rgba(0, 180, 94, 0.5);
    }

    &.editable + &.editable {
      border-left: 1px solid transparent;
    }

    &:not(.editable) + .editable {
      border-left: $effect;
    }
  }

  .table-actions {
    display: flex;
    padding: 10px 0;
    justify-content: flex-end;
    background-color: #ffffff;

    button {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 32px !important;
      height: 32px !important;
      margin-right: 10px;
      background-repeat: no-repeat;
      background-position: center;
      border: 1px solid $button-border-color;
      border-radius: 2px;
      cursor: pointer;
      outline: none;
      padding: 0;
      background-color: #ffffff;

      &:hover {
        background-color: $button-hover-background-color;
      }

      &.button-selected {
        border: 2px solid $button-selected;
      }
    }

    :last-child {
      margin-right: 0;
    }
  }
}
